<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <title>TreasureFind</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./map.css">
    <link id = "manifest" rel="manifest" href="./manifest.json">
    <script src="./functions.js"></script>
    <base href="/[repo]/">
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-dark">
            <a class="navbar-brand" href="#">TreasureFind</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup"
                    aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                    <!-- <a class="nav-item nav-link" href="/homepage">Instructions</a> -->
                    <!-- <a class="nav-item nav-link" href="/map">Map</a> -->
                    <a class="nav-item nav-link" onclick="newGame()">Start</a>
                </div>
            </div>
        </nav>
    </header>
    <!-- <div class="container">
        <div class="row">
            <div class="col-sm-12">
                        <div class="alert alert-{{ label }}">
                        </div>
            </div>
        </div>
    </div> -->
    <div class="container-fluid">
        <h1>Map</h1>
        <div class="row">
            <div class="col-md-10">
                <div class="map" style="max-height:100vh;">
                    <div class="row column" style="display: none;">
                        <div class="tile col-1">
                            <div class="tile-name"></div>
                            <div class="tile-name coords"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <!-- <div class="infos">
                    <h2>Information</h2>
                    <p>
                        The boat is at <span id = "currentBoatCoords">1,1</span> which is <span id = "currentTileType">sea</span>
                    </p>
                </div> -->
                <div class="navigation">
                    <h2>Navigation</h2>
                    <a onclick="moveDirection('N')" class="north" style="left: 50%;top:0;">N</a>
                    <a onclick="moveDirection('S')" class="south" style="left:50%;top:90%;">S</a>
                    <a onclick="moveDirection('E')" class="east" style="left:95%;top:46%;">E</a>
                    <a onclick="moveDirection('W')" class="west" style="top:46%;left:4%;">W</a>
                </div>
            </div>
        </div>
    </div>
    <img class="boat img-fluid" src="/images/boat.png" alt="Black Pearl" style="display: none;"/>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
            integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
            crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
            integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
            crossorigin="anonymous"></script>
</body>
</html>
<script>
    if(localStorage.getItem('boatCordX') == null || localStorage.getItem('boatCordX') == undefined)
    {
        localStorage.setItem('boatCordX', 1);
    }
    if(localStorage.getItem('boatCordY') == null || localStorage.getItem('boatCordY') == undefined)
    {
        localStorage.setItem('boatCordY', 1);
    }
    if(localStorage.getItem('treasureCordX') == null || localStorage.getItem('treasureCordX') == undefined)
    {
        localStorage.setItem('treasureCordX', Math.floor(Math.random() * 5)+1);
    }
    if(localStorage.getItem('treasureCordY') == null || localStorage.getItem('treasureCordY') == undefined)
    {
        localStorage.setItem('treasureCordY', Math.floor(Math.random() * 5)+1);
    }
    console.log(localStorage.getItem('treasureCordX'))
    console.log(localStorage.getItem('treasureCordY'))
    const possibleValues = ['sea', 'island', 'sea', 'port', 'sea', 'sea', 'sea'];
    for (let i = 1; i <= 6; i++) 
    {
        for (let j = 1; j <= 12; j++) 
        {
            if(localStorage.getItem(i+'-'+j) == null || localStorage.getItem(i+'-'+j) == undefined)
            {
                let type = possibleValues[Math.floor(Math.random() * possibleValues.length)]
                localStorage.setItem(i+'-'+j, type);
            }
        }
    }

    let boatx = localStorage.getItem('boatCordX');
    let boaty = localStorage.getItem('boatCordY');
    const column = document.querySelector('.row.column');
    const map = document.querySelector('.map');
    const tile = document.querySelector('.tile');
    const boat = document.querySelector('.boat');
    const manifest = document.querySelector('#manifest');
    if(!window.location.href.match(/C:/) && !window.location.href.match(/127/))
    {
        manifest.href = '/treasurefind_js/manifest.json';
    }
    for (let y = 1; y <= 6; y++) 
    {
        let col = column.cloneNode();
        for (let x = 1; x <= 12; x++) 
        {
            let tileClone = tile.cloneNode() 
            tileClone.dataset.cordX = x;
            tileClone.dataset.cordY = y;
            col.appendChild(tileClone);
            if(boatx == x && boaty == y)
            {
                tileClone.appendChild(boat);
                boat.style.display = "block";
                if(!window.location.href.match(/C:/) && !window.location.href.match(/127/))
                {
                    boat.src = '/treasurefind_js/images/boat.png';
                }
            }
            tileClone.classList.add(localStorage.getItem(y+'-'+x))
        }
        map.appendChild(col);
        col.style.display = "flex";
    }

   
</script>


